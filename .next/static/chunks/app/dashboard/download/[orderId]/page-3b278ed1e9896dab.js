(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5416],{1397:(e,s,t)=>{"use strict";t.d(s,{k:()=>i});var a=t(5155);t(2115);var r=t(5863),n=t(3999);function i(e){let{className:s,value:t,...i}=e;return(0,a.jsx)(r.bL,{"data-slot":"progress",className:(0,n.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...i,children:(0,a.jsx)(r.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})}},1854:(e,s,t)=>{Promise.resolve().then(t.bind(t,7941))},2495:(e,s,t)=>{"use strict";t.d(s,{DashboardSidebar:()=>R});var a=t(5155),r=t(2115),n=t(6874),i=t.n(n),l=t(5695),d=t(7168),c=t(1085),o=t(9663),m=t(3783),x=t(7809),h=t(6151),u=t(1007),f=t(381),g=t(7580),j=t(5937),p=t(5525),v=t(3817),N=t(9621),b=t(3314),w=t(3052),y=t(2355),k=t(4835),A=t(4783),C=t(6052),T=t(8738);let E=e=>{let s=[{title:"Tổng quan",href:"/dashboard",icon:m.A},{title:"Giỏ h\xe0ng",href:"/cart",icon:x.A},{title:"Đơn h\xe0ng đ\xe3 mua",href:"/dashboard/purchases",icon:h.A},{title:"Th\xf4ng tin t\xe0i khoản",href:"/dashboard/profile",icon:u.A},{title:"C\xe0i đặt",href:"/dashboard/settings",icon:f.A}],t=[{title:"Tổng quan",href:"/dashboard",icon:m.A},{title:"Quản l\xfd người d\xf9ng",href:"/admin/users",icon:g.A},{title:"Quản l\xfd cửa h\xe0ng t\xe0i khoản",href:"/admin/accounts",icon:j.A},{title:"Cấp t\xe0i khoản dịch vụ",href:"/admin/account-provisioning",icon:p.A},{title:"Quản l\xfd danh mục",href:"/admin/categories",icon:v.A},{title:"Quản l\xfd Source Code",href:"/admin/sourcecodes",icon:N.A},{title:"Quản l\xfd IDE v\xe0 Tools",href:"/admin/ide-tools",icon:b.A},{title:"C\xe0i đặt",href:"/dashboard/settings",icon:f.A}];return"admin"===e?t:s};function R(){let[e,s]=(0,r.useState)(!1),{isCollapsed:t,toggleSidebar:n}=(0,T.c)(),m=(0,l.usePathname)(),{user:x,logout:h}=(0,C.A)(),u=e=>{var r;let{collapsed:l=!1}=e;return(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"p-4 border-b border-border ".concat(l?"px-2":""),children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(o.eu,{className:"h-8 w-8 flex-shrink-0",children:[(0,a.jsx)(o.BK,{src:"/placeholder.svg"}),(0,a.jsx)(o.q5,{children:(null==x?void 0:null===(r=x.name)||void 0===r?void 0:r[0])||"U"})]}),!l&&(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-sm truncate",children:(null==x?void 0:x.name)||"Người d\xf9ng"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:null==x?void 0:x.email})]})]})}),(0,a.jsxs)("nav",{className:"flex-1 p-3",children:[(0,a.jsx)("div",{className:"space-y-1",children:E((null==x?void 0:x.role)||"user").map(e=>{let t=m===e.href;return(0,a.jsxs)(i(),{href:e.href,className:"flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ".concat(t?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted"," ").concat(l?"justify-center":""),onClick:()=>s(!1),title:l?e.title:void 0,children:[(0,a.jsx)(e.icon,{className:"h-4 w-4 flex-shrink-0"}),!l&&e.title]},e.href)})}),(0,a.jsx)("div",{className:"mt-4 pt-3 border-t border-border ".concat(l?"px-0":""),children:(0,a.jsxs)(d.$,{variant:"outline",size:"sm",className:"w-full h-8 text-xs bg-transparent",onClick:n,children:[t?(0,a.jsx)(w.A,{className:"h-3 w-3"}):(0,a.jsx)(y.A,{className:"h-3 w-3"}),!t&&(0,a.jsx)("span",{className:"ml-2",children:"Thu gọn"})]})})]}),(0,a.jsx)("div",{className:"p-3 border-t border-border ".concat(l?"px-2":""),children:(0,a.jsxs)(d.$,{variant:"ghost",className:"w-full text-muted-foreground hover:text-foreground ".concat(l?"justify-center px-2":"justify-start"),onClick:h,title:l?"Đăng xuất":void 0,children:[(0,a.jsx)(k.A,{className:"h-4 w-4 flex-shrink-0"}),!l&&(0,a.jsx)("span",{className:"ml-2",children:"Đăng xuất"})]})})]})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"hidden lg:flex lg:flex-col lg:fixed lg:top-16 lg:bottom-0 lg:border-r lg:border-border lg:bg-card transition-all duration-300 z-30 ".concat(t?"lg:w-16":"lg:w-64"),children:(0,a.jsx)(u,{collapsed:t})}),(0,a.jsxs)(c.cj,{open:e,onOpenChange:s,children:[(0,a.jsx)(c.CG,{asChild:!0,className:"lg:hidden",children:(0,a.jsx)(d.$,{variant:"ghost",size:"icon",className:"fixed top-4 left-4 z-40",children:(0,a.jsx)(A.A,{className:"h-5 w-5"})})}),(0,a.jsx)(c.h,{side:"left",className:"w-64 p-0",children:(0,a.jsx)(u,{})})]})]})}},7550:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7941:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>N});var a=t(5155),r=t(2115),n=t(5695),i=t(7168),l=t(8482),d=t(8145),c=t(1397),o=t(7550),m=t(5339),x=t(5761),h=t(646),u=t(4186),f=t(1788),g=t(6671),j=t(2495),p=t(8738),v=t(1886);function N(){let{isCollapsed:e}=(0,p.c)(),s=(0,n.useParams)(),t=(0,n.useRouter)(),N=s.orderId,[b,w]=(0,r.useState)(null),[y,k]=(0,r.useState)(!0),[A,C]=(0,r.useState)(!1),[T,E]=(0,r.useState)(null),[R,S]=(0,r.useState)(0),z=async()=>{try{k(!0),E(null);let e=localStorage.getItem("token");if(!e){E("Vui l\xf2ng đăng nhập để tải xuống");return}let s=await fetch("".concat(v.JR,"/api/download/info/").concat(N),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.message||"Kh\xf4ng thể tải th\xf4ng tin tải xuống")}let t=await s.json();w(t.data)}catch(e){console.error("Error fetching download info:",e),E(e.message||"C\xf3 lỗi xảy ra khi tải dữ liệu")}finally{k(!1)}},D=async()=>{if(!b||!b.canDownload){g.oR.error("Kh\xf4ng thể tải xuống file n\xe0y");return}try{C(!0),S(0);let e=localStorage.getItem("token");if(!e){g.oR.error("Vui l\xf2ng đăng nhập để tải xuống");return}let s=await fetch("".concat(v.JR,"/api/download/source-code/").concat(N),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.message||"Kh\xf4ng thể tải xuống file")}let t=s.headers.get("content-disposition"),a=b.fileName;if(t){let e=t.match(/filename="?([^"]+)"?/);e&&(a=e[1])}let r=await s.blob(),n=window.URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n),g.oR.success("Tải xuống th\xe0nh c\xf4ng!"),setTimeout(()=>{z()},1e3)}catch(e){console.error("Error downloading file:",e),g.oR.error(e.message||"C\xf3 lỗi xảy ra khi tải xuống")}finally{C(!1),S(0)}};return(0,r.useEffect)(()=>{N&&z()},[N]),(0,a.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,a.jsx)(j.DashboardSidebar,{}),(0,a.jsx)("div",{className:"flex-1 transition-all duration-300 ".concat(e?"lg:pl-16":"lg:pl-64"),children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)(i.$,{variant:"ghost",onClick:()=>t.back(),className:"mb-4",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Quay lại"]}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Tải xuống Source Code"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"Tải xuống file source code đ\xe3 mua"})]}),y?(0,a.jsxs)(l.Zp,{className:"animate-pulse",children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-3/4 mb-2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),(0,a.jsx)(l.Wu,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3"}),(0,a.jsx)("div",{className:"h-10 bg-gray-200 rounded"})]})})]}):T?(0,a.jsx)(l.Zp,{children:(0,a.jsx)(l.Wu,{className:"text-center py-12",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(m.A,{className:"h-6 w-6 text-red-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Lỗi tải dữ liệu"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:T})]}),(0,a.jsx)(i.$,{onClick:z,children:"Thử lại"})]})})}):b?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"h-5 w-5"}),b.productName]}),(0,a.jsxs)(l.BT,{children:["M\xe3 đơn h\xe0ng: ",b.orderId]})]}),(0,a.jsx)(d.E,{variant:b.canDownload?"default":"secondary",className:"flex items-center gap-1",children:b.canDownload?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"h-3 w-3"})," C\xf3 thể tải xuống"]}):b.isExpired?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"h-3 w-3"})," Đ\xe3 hết hạn"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.A,{className:"h-3 w-3"})," Hết lượt tải"]})})]})}),(0,a.jsxs)(l.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"T\xean file"}),(0,a.jsx)("p",{className:"font-medium",children:b.fileName})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"K\xedch thước"}),(0,a.jsx)("p",{className:"font-medium",children:b.fileSize})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Hết hạn"}),(0,a.jsx)("p",{className:"font-medium",children:new Date(b.expiresAt).toLocaleString("vi-VN")})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:"Lượt tải đ\xe3 sử dụng"}),(0,a.jsxs)("span",{children:[b.downloadCount," / ",b.maxDownloads]})]}),(0,a.jsx)(c.k,{value:b.downloadCount/b.maxDownloads*100,className:"h-2"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["C\xf2n lại ",b?Math.max(0,b.maxDownloads-b.downloadCount):0," lượt tải xuống"]})]}),A&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:"Đang tải xuống..."}),(0,a.jsxs)("span",{children:[R,"%"]})]}),(0,a.jsx)(c.k,{value:R,className:"h-2"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(i.$,{onClick:D,disabled:!b.canDownload||A,className:"flex-1",children:[(0,a.jsx)(f.A,{className:"h-4 w-4 mr-2"}),A?"Đang tải xuống...":"Tải xuống"]}),(0,a.jsx)(i.$,{variant:"outline",onClick:z,disabled:A,children:"L\xe0m mới"})]})]})]}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsx)(l.ZB,{children:"Hướng dẫn tải xuống"})}),(0,a.jsxs)(l.Wu,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-medium mt-0.5",children:"1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Kiểm tra th\xf4ng tin"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Đảm bảo bạn c\xf3 đủ lượt tải v\xe0 file chưa hết hạn"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-medium mt-0.5",children:"2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Nhấn tải xuống"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"File sẽ được tải về m\xe1y t\xednh của bạn"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-sm font-medium mt-0.5",children:"3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Giải n\xe9n v\xe0 sử dụng"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Giải n\xe9n file .zip/.rar v\xe0 l\xe0m theo hướng dẫn b\xean trong"})]})]})]})]})]}):null]})})]})}},8145:(e,s,t)=>{"use strict";t.d(s,{E:()=>d});var a=t(5155);t(2115);var r=t(9708),n=t(2085),i=t(3999);let l=(0,n.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:s,variant:t,asChild:n=!1,...d}=e,c=n?r.DX:"span";return(0,a.jsx)(c,{"data-slot":"badge",className:(0,i.cn)(l({variant:t}),s),...d})}},8482:(e,s,t)=>{"use strict";t.d(s,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>n,aR:()=>i,wL:()=>o});var a=t(5155);t(2115);var r=t(3999);function n(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...t})}function i(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...t})}function l(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",s),...t})}function d(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",s),...t})}function c(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",s),...t})}function o(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-footer",className:(0,r.cn)("flex items-center px-6 [.border-t]:pt-6",s),...t})}},9663:(e,s,t)=>{"use strict";t.d(s,{BK:()=>l,eu:()=>i,q5:()=>d});var a=t(5155);t(2115);var r=t(5977),n=t(3999);function i(e){let{className:s,...t}=e;return(0,a.jsx)(r.bL,{"data-slot":"avatar",className:(0,n.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",s),...t})}function l(e){let{className:s,...t}=e;return(0,a.jsx)(r._V,{"data-slot":"avatar-image",className:(0,n.cn)("aspect-square size-full",s),...t})}function d(e){let{className:s,...t}=e;return(0,a.jsx)(r.H4,{"data-slot":"avatar-fallback",className:(0,n.cn)("bg-muted flex size-full items-center justify-center rounded-full",s),...t})}}},e=>{var s=s=>e(e.s=s);e.O(0,[9460,7244,409,5452,6671,4637,7684,8441,1684,7358],()=>s(1854)),_N_E=e.O()}]);